CREATE DATABASE IF NOT EXISTS library;

USE library;

-- Drop existing tables if they exist
DROP TABLE IF EXISTS `RentalBooks`;
DROP TABLE IF EXISTS `Rentals`;
DROP TABLE IF EXISTS `Students`;
DROP TABLE IF EXISTS `Books`;
DROP TABLE IF EXISTS `Users`;

CREATE TABLE Students (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    FirstName VARCHAR(100) NOT NULL,
    LastName VARCHAR(100) NOT NULL,
    Phone VARCHAR(15) NOT NULL,
    Email VARCHAR(100) NOT NULL
);

CREATE TABLE Books (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Title VARCHAR(255) NOT NULL,
    Author VARCHAR(100) NOT NULL,
    Publisher VARCHAR(100) NOT NULL,
    PublishDate DATE NOT NULL,
    ISBN VARCHAR(20) NOT NULL,
    Stock INT NOT NULL
);

CREATE TABLE Rentals (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    RentalDate DATETIME NOT NULL,
    ReturnDate DATETIME NOT NULL,
    StudentId INT NOT NULL,
    FOREIGN KEY (StudentId) REFERENCES Students(Id)
);

CREATE TABLE RentalBooks (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    BookId INT NOT NULL,
    Quantity INT NOT NULL,
    RentalID INT NOT NULL,
    FOREIGN KEY (BookId) REFERENCES Books(Id),
    FOREIGN KEY (RentalID) REFERENCES Rentals(Id)
);

CREATE TABLE Users (
    Id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(100) NOT NULL,
    Account VARCHAR(100) NOT NULL,
    Password VARCHAR(100) NOT NULL,
    Phone VARCHAR(15) NOT NULL,
    Email VARCHAR(100) NOT NULL
);
